!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){function t(s,i){var n=function(){},n={autoSelectFirst:!1,appendTo:"body",serviceUrl:null,lookup:null,onSelect:null,width:"auto",minChars:1,maxHeight:300,deferRequestBy:0,params:{},formatResult:t.formatResult,delimiter:null,zIndex:9999,type:"GET",noCache:!1,onSearchStart:n,onSearchComplete:n,onSearchError:n,containerClass:"autocomplete-suggestions",tabDisabled:!1,dataType:"text",currentRequest:null,triggerSelectOnValidInput:!0,lookupFilter:function(e,t,s){return-1!==e.value.toLowerCase().indexOf(s)},paramName:"query",transformResult:function(t){return"string"==typeof t?e.parseJSON(t):t}};this.element=s,this.el=e(s),this.suggestions=[],this.badQueries=[],this.selectedIndex=-1,this.currentValue=this.element.value,this.intervalId=0,this.cachedResponse={},this.onChange=this.onChangeInterval=null,this.isLocal=!1,this.suggestionsContainer=null,this.options=e.extend({},n,i),this.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"},this.hint=null,this.hintValue="",this.selection=null,this.initialize(),this.setOptions(i)}var s=function(){return{escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},createNode:function(e){var t=document.createElement("div");return t.className=e,t.style.position="absolute",t.style.display="none",t}}}();t.utils=s,e.Autocomplete=t,t.formatResult=function(e,t){var i="("+s.escapeRegExChars(t)+")";return e.value.replace(RegExp(i,"gi"),"<strong>$1</strong>")},t.prototype={killerFn:null,initialize:function(){var s,i=this,n="."+i.classes.suggestion,o=i.classes.selected,l=i.options;i.element.setAttribute("autocomplete","off"),i.killerFn=function(t){0===e(t.target).closest("."+i.options.containerClass).length&&(i.killSuggestions(),i.disableKillerFn())},i.suggestionsContainer=t.utils.createNode(l.containerClass),s=e(i.suggestionsContainer),s.appendTo(l.appendTo),"auto"!==l.width&&s.width(l.width),s.on("mouseover.autocomplete",n,function(){i.activate(e(this).data("index"))}),s.on("mouseout.autocomplete",function(){i.selectedIndex=-1,s.children("."+o).removeClass(o)}),s.on("click.autocomplete",n,function(){i.select(e(this).data("index"))}),i.fixPosition(),i.fixPositionCapture=function(){i.visible&&i.fixPosition()},e(window).on("resize.autocomplete",i.fixPositionCapture),i.el.on("keydown.autocomplete",function(e){i.onKeyPress(e)}),i.el.on("keyup.autocomplete",function(e){i.onKeyUp(e)}),i.el.on("blur.autocomplete",function(){i.onBlur()}),i.el.on("focus.autocomplete",function(){i.onFocus()}),i.el.on("change.autocomplete",function(e){i.onKeyUp(e)})},onFocus:function(){this.fixPosition(),this.options.minChars<=this.el.val().length&&this.onValueChange()},onBlur:function(){this.enableKillerFn()},setOptions:function(t){var s=this.options;e.extend(s,t),(this.isLocal=e.isArray(s.lookup))&&(s.lookup=this.verifySuggestionsFormat(s.lookup)),e(this.suggestionsContainer).css({"max-height":s.maxHeight+"px",width:s.width+"px","z-index":s.zIndex})},clearCache:function(){this.cachedResponse={},this.badQueries=[]},clear:function(){this.clearCache(),this.currentValue="",this.suggestions=[]},disable:function(){this.disabled=!0,this.currentRequest&&this.currentRequest.abort()},enable:function(){this.disabled=!1},fixPosition:function(){var t;"body"===this.options.appendTo&&(t=this.el.offset(),t={top:t.top+this.el.outerHeight()+"px",left:t.left+"px"},"auto"===this.options.width&&(t.width=this.el.outerWidth()-2+"px"),e(this.suggestionsContainer).css(t))},enableKillerFn:function(){e(document).on("click.autocomplete",this.killerFn)},disableKillerFn:function(){e(document).off("click.autocomplete",this.killerFn)},killSuggestions:function(){var e=this;e.stopKillSuggestions(),e.intervalId=window.setInterval(function(){e.hide(),e.stopKillSuggestions()},50)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},isCursorAtEnd:function(){var e=this.el.val().length,t=this.element.selectionStart;return"number"==typeof t?t===e:!document.selection||(t=document.selection.createRange(),t.moveStart("character",-e),e===t.text.length)},onKeyPress:function(e){if(this.disabled||this.visible||40!==e.which||!this.currentValue){if(!this.disabled&&this.visible){switch(e.which){case 27:this.el.val(this.currentValue),this.hide();break;case 39:if(this.hint&&this.options.onHint&&this.isCursorAtEnd()){this.selectHint();break}return;case 9:if(this.hint&&this.options.onHint)return void this.selectHint();case 13:if(-1===this.selectedIndex)return void this.hide();if(this.select(this.selectedIndex),9===e.which&&!1===this.options.tabDisabled)return;break;case 38:this.moveUp();break;case 40:this.moveDown();break;default:return}e.stopImmediatePropagation(),e.preventDefault()}}else this.suggest()},onKeyUp:function(e){var t=this;if(!t.disabled){switch(e.which){case 38:case 40:return}clearInterval(t.onChangeInterval),t.currentValue!==t.el.val()&&(t.findBestHint(),0<t.options.deferRequestBy?t.onChangeInterval=setInterval(function(){t.onValueChange()},t.options.deferRequestBy):t.onValueChange())}},onValueChange:function(){var t=this.options,s=this.el.val(),i=this.getQuery(s);return this.selection&&(this.selection=null,(t.onInvalidateSelection||e.noop).call(this.element)),clearInterval(this.onChangeInterval),this.currentValue=s,this.selectedIndex=-1,t.triggerSelectOnValidInput&&(s=this.findSuggestionIndex(i),-1!==s)?void this.select(s):void(i.length<t.minChars?this.hide():this.getSuggestions(i))},findSuggestionIndex:function(t){var s=-1,i=t.toLowerCase();return e.each(this.suggestions,function(e,t){if(t.value.toLowerCase()===i)return s=e,!1}),s},getQuery:function(t){var s=this.options.delimiter;return s?(t=t.split(s),e.trim(t[t.length-1])):t},getSuggestionsLocal:function(t){var s=this.options,i=t.toLowerCase(),n=s.lookupFilter,o=parseInt(s.lookupLimit,10),s={suggestions:e.grep(s.lookup,function(e){return n(e,t,i)})};return o&&s.suggestions.length>o&&(s.suggestions=s.suggestions.slice(0,o)),s},getSuggestions:function(t){var s,i,n,o=this,l=o.options,a=l.serviceUrl;l.params[l.paramName]=t,i=l.ignoreParams?null:l.params,o.isLocal?s=o.getSuggestionsLocal(t):(e.isFunction(a)&&(a=a.call(o.element,t)),n=a+"?"+e.param(i||{}),s=o.cachedResponse[n]),s&&e.isArray(s.suggestions)?(o.suggestions=s.suggestions,o.suggest()):o.isBadQuery(t)||!1===l.onSearchStart.call(o.element,l.params)||(o.currentRequest&&o.currentRequest.abort(),o.currentRequest=e.ajax({url:a,data:i,type:l.type,dataType:l.dataType}).done(function(e){o.currentRequest=null,o.processResponse(e,t,n),l.onSearchComplete.call(o.element,t)}).fail(function(e,s,i){l.onSearchError.call(o.element,t,e,s,i)}))},isBadQuery:function(e){for(var t=this.badQueries,s=t.length;s--;)if(0===e.indexOf(t[s]))return!0;return!1},hide:function(){this.visible=!1,this.selectedIndex=-1,e(this.suggestionsContainer).hide(),this.signalHint(null)},suggest:function(){if(0===this.suggestions.length)this.hide();else{var t,s=this.options,i=s.formatResult,n=this.getQuery(this.currentValue),o=this.classes.suggestion,l=this.classes.selected,a=e(this.suggestionsContainer),u=s.beforeRender,r="";if(s.triggerSelectOnValidInput&&(t=this.findSuggestionIndex(n),-1!==t))return void this.select(t);e.each(this.suggestions,function(e,t){r+='<div class="'+o+'" data-index="'+e+'">'+i(t,n)+"</div>"}),"auto"===s.width&&(t=this.el.outerWidth()-2,a.width(0<t?t:300)),a.html(r),s.autoSelectFirst&&(this.selectedIndex=0,a.children().first().addClass(l)),e.isFunction(u)&&u.call(this.element,a),a.show(),this.visible=!0,this.findBestHint()}},findBestHint:function(){var t=this.el.val().toLowerCase(),s=null;t&&(e.each(this.suggestions,function(e,i){var n=0===i.value.toLowerCase().indexOf(t);return n&&(s=i),!n}),this.signalHint(s))},signalHint:function(t){var s="";t&&(s=this.currentValue+t.value.substr(this.currentValue.length)),this.hintValue!==s&&(this.hintValue=s,this.hint=t,(this.options.onHint||e.noop)(s))},verifySuggestionsFormat:function(t){return t.length&&"string"==typeof t[0]?e.map(t,function(e){return{value:e,data:null}}):t},processResponse:function(e,t,s){var i=this.options;e=i.transformResult(e,t),e.suggestions=this.verifySuggestionsFormat(e.suggestions),i.noCache||(this.cachedResponse[s]=e,0===e.suggestions.length&&this.badQueries.push(s)),t===this.getQuery(this.currentValue)&&(this.suggestions=e.suggestions,this.suggest())},activate:function(t){var s=this.classes.selected,i=e(this.suggestionsContainer),n=i.children();return i.children("."+s).removeClass(s),this.selectedIndex=t,-1!==this.selectedIndex&&n.length>this.selectedIndex?(t=n.get(this.selectedIndex),e(t).addClass(s),t):null},selectHint:function(){var t=e.inArray(this.hint,this.suggestions);this.select(t)},select:function(e){this.hide(),this.onSelect(e)},moveUp:function(){-1!==this.selectedIndex&&(0===this.selectedIndex?(e(this.suggestionsContainer).children().first().removeClass(this.classes.selected),this.selectedIndex=-1,this.el.val(this.currentValue),this.findBestHint()):this.adjustScroll(this.selectedIndex-1))},moveDown:function(){this.selectedIndex!==this.suggestions.length-1&&this.adjustScroll(this.selectedIndex+1)},adjustScroll:function(t){var s,i,n=this.activate(t);n&&(n=n.offsetTop,s=e(this.suggestionsContainer).scrollTop(),i=s+this.options.maxHeight-25,n<s?e(this.suggestionsContainer).scrollTop(n):n>i&&e(this.suggestionsContainer).scrollTop(n-this.options.maxHeight+25),this.el.val(this.getValue(this.suggestions[t].value)),this.signalHint(null))},onSelect:function(t){var s=this.options.onSelect;t=this.suggestions[t],this.currentValue=this.getValue(t.value),this.el.val(this.currentValue),this.signalHint(null),this.suggestions=[],this.selection=t,e.isFunction(s)&&s.call(this.element,t)},getValue:function(e){var t,s=this.options.delimiter;return s?(t=this.currentValue,s=t.split(s),1===s.length?e:t.substr(0,t.length-s[s.length-1].length)+e):e},dispose:function(){this.el.off(".autocomplete").removeData("autocomplete"),this.disableKillerFn(),e(window).off("resize.autocomplete",this.fixPositionCapture),e(this.suggestionsContainer).remove()}},e.fn.autocomplete=function(s,i){return 0===arguments.length?this.first().data("autocomplete"):this.each(function(){var n=e(this),o=n.data("autocomplete");"string"==typeof s?o&&"function"==typeof o[s]&&o[s](i):(o&&o.dispose&&o.dispose(),o=new t(this,s),n.data("autocomplete",o))})}});
//# sourceMappingURL=maps/jquery.autocomplete-min.js.map
